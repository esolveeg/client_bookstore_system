(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e3256a0"],{"2a32":function(t,e,a){"use strict";var s=a("c09a"),i=a.n(s);i.a},c09a:function(t,e,a){},ee11:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("Breadcrumbs",{attrs:{title:t.pageTitle,path:t.path,fregment:t.fregment}}),a("div",{staticClass:"col s12 mt-65"},[a("div",{staticClass:"container"},[a("div",{staticClass:"row mt-4"},[a("div",{staticClass:"col s12 m12 l12"},[a("h5",{staticClass:"form-title"},[a("i",{staticClass:"material-icons app-header-icon text-top"},[t._v("perm_identity")]),t._v(" "+t._s(t.$t(t.pageTitle,{fregment:t.fregment}))+" ")]),a("div",{staticClass:"card animated  fadeInLeft "},[a("div",{staticClass:"card-content"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.submitted()}}},[t.validationError?a("div",{staticClass:"card-alert danger card"},[a("div",{staticClass:"card-content"},[a("p",[a("i",{staticClass:"material-icons"},[t._v("error")]),t._v(t._s(t.validationError)+" ")])])]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12",class:{error:t.validation.hasError("title")}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{id:"title",type:"text"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),a("label",{class:t.title?"active":"",attrs:{for:"title"}},[t._v(t._s(t.$t("title")))]),a("div",{staticClass:"message"},[t._v(" "+t._s(t.validation.firstError("title"))+" ")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12",class:{error:t.validation.hasError("type")}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],attrs:{id:"type"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.type=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"none"}},[t._v(t._s(t.$t("select_type")))]),a("option",{attrs:{value:"value"}},[t._v(t._s(t.$t("value")))]),a("option",{attrs:{value:"percent_off"}},[t._v(t._s(t.$t("percent")))])]),a("label",{class:t.type?"active":"",attrs:{for:"type"}},[t._v(t._s(t.$t("type")))]),a("div",{staticClass:"message"},[t._v(" "+t._s(t.validation.firstError("type"))+" ")])])]),t.isPercent?a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12",class:{error:t.validation.hasError("percent")}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.percent,expression:"percent"}],attrs:{id:"percent",type:"text"},domProps:{value:t.percent},on:{input:function(e){e.target.composing||(t.percent=e.target.value)}}}),a("label",{class:t.percent?"active":"",attrs:{for:"percent"}},[t._v(t._s(t.$t("percent")))]),a("div",{staticClass:"message"},[t._v(" "+t._s(t.validation.firstError("percent"))+" ")])])]):t._e(),t.isValue?a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12",class:{error:t.validation.hasError("value")}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],attrs:{id:"value",type:"text"},domProps:{value:t.value},on:{input:function(e){e.target.composing||(t.value=e.target.value)}}}),a("label",{class:t.value?"active":"",attrs:{for:"value"}},[t._v(t._s(t.$t("value")))]),a("div",{staticClass:"message"},[t._v(" "+t._s(t.validation.firstError("value"))+" ")])])]):t._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12",class:{error:t.validation.hasError("products")}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.products,expression:"products"}],attrs:{id:"products",multiple:""},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.products=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"none"}},[t._v(t._s(t.$t("select_product")))]),t._l(t.allProducts,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),a("label",{class:t.products?"active":"",attrs:{for:"products"}},[t._v(t._s(t.$t("products")))]),a("div",{staticClass:"message"},[t._v(" "+t._s(t.validation.firstError("products"))+" ")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.branch,expression:"branch"}],attrs:{id:"branches"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.branch=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"none"}},[t._v(t._s(t.$t("select_branch")))]),t._l(t.allBranches,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])}))],2),a("label",{class:t.branches?"active":"",attrs:{for:"branches"}},[t._v(t._s(t.$t("branches")))])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"input-field col s12"},[a("button",{staticClass:"btn create cyan waves-effect waves-light left",attrs:{type:"submit",name:"action",disabled:"disabled"}},[t._v(" "+t._s(t.$t("save"))+" "),a("i",{staticClass:"material-icons right"},[t._v("send")])])])])])])])])])])])],1)},i=[],r=(a("4160"),a("b0c0"),a("e25e"),a("159b"),a("85f2")),n=a("4d5c"),o=a.n(n),l=a("95b1"),c=a.n(l),u=a("f2b3"),d=c.a.Validator,v={components:{Breadcrumbs:r["a"]},data:function(){return{path:[{title:"discounts",route:"discounts.index"}],discount:{},type:"",value:"",title:"",percent:"",isValue:!1,isPercent:!1,branch:"",id:"",products:[],qty:"",pageTitle:"create_discount",validationError:"",fregment:""}},validators:{type:function(t){return d.value(t).required()},value:function(t){return d.value(t).digit().maxLength(5)},percent:function(t){return d.value(t).digit().maxLength(2)},products:function(t){return d.value(t).required()},title:function(t){return d.value(t).required().maxLength(250)}},apollo:{discount:function(){return{query:u["Q"],variables:function(){return{id:parseInt(this.$route.params.id)}},result:function(t){var e=this,a=t.data.discount;this.type=a.type,setTimeout((function(){"value"==a.type?(e.isPercent=!1,e.isValue=!0):"percent_off"==e.type&&(e.isValue=!1,e.isPercent=!0)}),1e3),this.value=a.value,this.title=a.title,this.percent=a.percent,this.branch=a.branch.id,a.products.forEach((function(t){console.log(t.id),e.products.push(t.id)}))}}},allProducts:function(){return{query:u["c"]}},allBranches:function(){return{query:u["a"]}}},watch:{"validation.errors":function(){var t=document.querySelector(".input-field button");this.validation.errors.length>0?t.setAttribute("disabled","disabled"):this.product?t.removeAttribute("disabled"):this.validation.touchedRecords.length>1&&t.removeAttribute("disabled")},type:function(){"value"==this.type?(this.isPercent=!1,this.isValue=!0):"percent_off"==this.type&&(this.isValue=!1,this.isPercent=!0)}},methods:{loadSelects:function(){var t=document.querySelectorAll("select");setTimeout((function(){o.a.FormSelect.init(t,{})}),2e3)},submitted:function(){"value"==this.type?this.percent="":"percent_off"==this.type&&(this.value=""),this.discount?this.updateDiscount():this.createDiscount()},updateDiscount:function(){var t=this;this.$apollo.mutate({mutation:u["kb"],variables:{id:parseInt(this.$route.params.id),type:this.type,value:this.value,title:this.title,percent:this.percent,isValue:this.isValue,isPercent:this.isPercent,branch:this.branch}}).then((function(e){o.a.toast({html:"".concat(t.$t("updated_successfully",{name:t.$t(e.data.updateDiscount.name)})),classes:"success toast",displayLength:2e3}),t.$router.push({name:"discounts.index"})})).catch((function(t){console.log(t)})),this.$apollo.mutate({mutation:u["i"],variables:{discount:parseInt(this.$route.params.id),products:this.products}}).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))},createDiscount:function(){var t=this;this.$apollo.mutate({mutation:u["h"],variables:{type:this.type,value:this.value,title:this.title,percent:this.percent,branch:this.branch}}).then((function(e){o.a.toast({html:"".concat(t.$t("created_successfully",{name:t.$t(e.data.createDiscount.name)})),classes:"success toast",displayLength:3e3}),t.id=e.data.createDiscount.id,t.$router.push({name:"discounts.index"})})).catch((function(){t.validationError=t.$t("name_unique")})),setTimeout((function(){t.$apollo.mutate({mutation:u["i"],variables:{discount:t.id,products:t.products}}).catch((function(t){console.log(t)}))}),2e3)}},mounted:function(){this.loadSelects()}},p={name:"edit-add-discounts",mixins:[v]},m=p,h=(a("2a32"),a("2877")),f=Object(h["a"])(m,s,i,!1,null,"53bee756",null);e["default"]=f.exports}}]);
//# sourceMappingURL=chunk-7e3256a0.3905a874.js.map