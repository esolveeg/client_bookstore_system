{"remainingRequest":"/root/ahmed/vueJs/systemfinal/node_modules/vue-loader/lib/index.js??vue-loader-options!/root/ahmed/vueJs/systemfinal/src/views/roles/Create.vue?vue&type=style&index=0&id=5ba4e6c8&lang=scss&scoped=true&","dependencies":[{"path":"/root/ahmed/vueJs/systemfinal/src/views/roles/Create.vue","mtime":1579101356536},{"path":"/root/ahmed/vueJs/systemfinal/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/ahmed/vueJs/systemfinal/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/root/ahmed/vueJs/systemfinal/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/root/ahmed/vueJs/systemfinal/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/ahmed/vueJs/systemfinal/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/root/ahmed/vueJs/systemfinal/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZm9ybS10aXRsZSB7CiAgZm9udC13ZWlnaHQ6IDcwMDsKICBsaW5lLWhlaWdodDogMy42cmVtOwogIGZvbnQtc2l6ZTogMi42NHJlbTsKICBtYXJnaW4tYm90dG9tOiA1cmVtOwogICYgaSB7CiAgICBmb250LXNpemU6IDMuNnJlbTsKICAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207CiAgfQp9CgpsYWJlbCB7CiAgZm9udC1zaXplOiAxLjZyZW0gIWltcG9ydGFudDsKfQppbnB1dCwKLmNoZWNrYm94IHNwYW46bm90KC5sZXZlciksCnRleHRhcmVhLApzZWxlY3QgewogIGZvbnQtc2l6ZTogMS42cmVtICFpbXBvcnRhbnQ7CiAgaGVpZ2h0OiA0LjJyZW0gIWltcG9ydGFudDsKfQouY2hlY2tib3ggewogIHBvc2l0aW9uOiByZWxhdGl2ZTsKfQo="},{"version":3,"sources":["Create.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Create.vue","sourceRoot":"src/views/roles","sourcesContent":["<template>\n  <div class=\"row\">\n    <Breadcrumbs :title=\"title\" :path=\"path\" :fregment=\"fregment\" />\n    <div class=\"col s12 mt-65\">\n      <div class=\"container\">\n        <!-- Current balance & total transactions cards-->\n        <div class=\"row mt-4\">\n          <div class=\"col s12 m12 l12\">\n            <!-- Current Balance -->\n            <h5 class=\"form-title\">\n              <i class=\"material-icons app-header-icon text-top\"\n                >perm_identity</i\n              >\n              {{ $t(title, { fregment }) }}\n            </h5>\n\n            <div class=\"card animated  fadeInLeft \">\n              <div class=\"card-content\">\n                <form @submit.prevent=\"submitted()\">\n                  <div class=\"card-alert danger card\" v-if=\"validationError\">\n                    <div class=\"card-content\">\n                      <p>\n                        <i class=\"material-icons\">error</i>{{ validationError }}\n                      </p>\n                    </div>\n                  </div>\n                  <div class=\"row\">\n                    <div\n                      class=\"input-field col s12\"\n                      :class=\"{ error: validation.hasError('name') }\"\n                    >\n                      <input v-model=\"name\" id=\"name\" type=\"text\" />\n                      <label for=\"name\" :class=\"name ? 'active' : ''\">{{\n                        $t(\"name\")\n                      }}</label>\n                      <div class=\"message\">\n                        {{ validation.firstError(\"name\") }}\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"row\">\n                    <div\n                      class=\"input-field col s12\"\n                      :class=\"{ error: validation.hasError('description') }\"\n                    >\n                      <textarea\n                        v-model=\"description\"\n                        id=\"description\"\n                        class=\"materialize-textarea\"\n                      ></textarea>\n                      <label\n                        for=\"description\"\n                        :class=\"description ? 'active' : ''\"\n                        >{{ $t(\"description\") }}</label\n                      >\n                      <div class=\"message\">\n                        {{ validation.firstError(\"description\") }}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"row\">\n                    <div\n                      class=\"input-field col s12\"\n                      :class=\"{ error: validation.hasError('users') }\"\n                    >\n                      <select id=\"users\" multiple v-model=\"users\">\n                        <option value=\"\" disabled=\"none\">{{\n                          $t(\"select_user\")\n                        }}</option>\n                        <option\n                          v-for=\"user in allUsers\"\n                          :key=\"user.id\"\n                          :value=\"user.id\"\n                          >{{ user.name }}</option\n                        >\n                      </select>\n                      <label for=\"users\" :class=\"users ? 'active' : ''\">{{\n                        $t(\"users\")\n                      }}</label>\n                      <div class=\"message\">\n                        {{ validation.firstError(\"users\") }}\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"row\">\n                    <div\n                      class=\"input-field col s12\"\n                      :class=\"{ error: validation.hasError('permissions') }\"\n                    >\n                      <select id=\"permissions\" multiple v-model=\"permissions\">\n                        <option value=\"\" disabled=\"none\">{{\n                          $t(\"select_permission\")\n                        }}</option>\n                        <option\n                          v-for=\"permission in allPermissions\"\n                          :key=\"permission.id\"\n                          :value=\"permission.id\"\n                          >{{ permission.name }}</option\n                        >\n                      </select>\n                      <label\n                        for=\"permissions\"\n                        :class=\"permissions ? 'active' : ''\"\n                        >{{ $t(\"permissions\") }}</label\n                      >\n                      <div class=\"message\">\n                        {{ validation.firstError(\"permissions\") }}\n                      </div>\n                    </div>\n                  </div>\n\n                  <div class=\"row\">\n                    <div class=\"input-field col s12\">\n                      <button\n                        class=\"btn create cyan waves-effect waves-light left\"\n                        type=\"submit\"\n                        name=\"action\"\n                        disabled=\"disabled\"\n                      >\n                        {{ $t(\"save\") }}\n                        <i class=\"material-icons right\">send</i>\n                      </button>\n                    </div>\n                  </div>\n                </form>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport Breadcrumbs from \"@/components/layouts/Breadcrumbs.vue\";\nimport M from \"materialize-css\";\nimport SimpleVueValidation from \"simple-vue-validator\";\nimport {\n  createRole,\n  updateRole,\n  roleQuery\n} from \"@/graphql/queries/queries.js\";\nconst Validator = SimpleVueValidation.Validator;\nimport gql from \"graphql-tag\";\nexport default {\n  name: \"edit-add-roles\",\n  components: {\n    Breadcrumbs\n  },\n  data() {\n    return {\n      path: [{ title: \"roles\", route: \"roles.index\" }],\n      roleById: {},\n      name: \"\",\n      slug: \"\",\n      description: \"\",\n      allUsers: \"\",\n      allPermissions: [],\n      users: [],\n      permissions: [],\n      title: \"create_role\",\n      validationError: \"\",\n      fregment: \"\"\n    };\n  },\n  validators: {\n    name(value) {\n      return Validator.value(value)\n        .required()\n        .minLength(3);\n    },\n    users(value) {\n      return Validator.value(value);\n    },\n    permissions(value) {\n      return Validator.value(value).required();\n    },\n\n    description(value) {\n      return Validator.value(value).minLength(3);\n    }\n  },\n\n  apollo: {\n    roleById() {\n      return {\n        query: roleQuery,\n        variables() {\n          return {\n            id: parseInt(this.$route.params.id)\n          };\n        },\n        fetchPolicy: \"network-only\",\n        result({ data: { roleById } }) {\n          this.name = roleById.name;\n          this.description = roleById.description;\n          this.slug = roleById.slug;\n          this.title = `edit`;\n          let users = [];\n          roleById.users.forEach(user => {\n            users.push(user.id);\n          });\n          let permissions = [];\n          roleById.permissions.forEach(per => {\n            permissions.push(per.id);\n          });\n\n          this.users = users;\n          this.permissions = permissions;\n        }\n      };\n    },\n    allUsers() {\n      return {\n        query: gql`\n          query {\n            allUsers {\n              name\n              id\n            }\n          }\n        `\n      };\n    },\n    allPermissions() {\n      return {\n        query: gql`\n          query {\n            allPermissions {\n              name\n              id\n            }\n          }\n        `\n      };\n    }\n  },\n\n  watch: {\n    \"validation.errors\"() {\n      const btn = document.querySelector(\".input-field button\");\n      if (this.validation.errors.length > 0) {\n        btn.setAttribute(\"disabled\", \"disabled\");\n      } else {\n        if (!this.role) {\n          this.validation.touchedRecords.length > 1\n            ? btn.removeAttribute(\"disabled\")\n            : \"\";\n        } else {\n          btn.removeAttribute(\"disabled\");\n        }\n      }\n    },\n    name() {\n      let slug = this.name.replace(\" \", \"-\");\n      slug = slug.replace(\"&\", \"-\");\n      slug = slug.replace(\"?\", \"-\");\n      slug = slug.replace(\"/\", \"-\");\n      slug = slug.replace(\"\\\\\", \"-\");\n      this.slug = slug;\n    }\n  },\n  methods: {\n    submitted() {\n      this.roleById ? this.updateRole() : this.createRole();\n    },\n    loadSelects() {\n      let selects = document.querySelectorAll(\"select\");\n      setTimeout(() => {\n        M.FormSelect.init(selects, {});\n      }, 2000);\n    },\n    updateRole() {\n      this.$apollo\n        .mutate({\n          mutation: updateRole,\n          // Parameters\n          variables: {\n            name: this.name,\n            slug: this.slug,\n            id: parseInt(this.$route.params.id),\n            description: this.description,\n            users: this.users,\n            permissions: this.permissions\n          }\n        })\n        .then(data => {\n          M.toast({\n            html: `${this.$t(\"updated_successfully\", {\n              name: data.data.updateRole.name\n            })}`,\n            classes: \"success toast\",\n            displayLength: 2000\n          });\n\n          this.$router.push({ name: \"roles.index\" });\n        })\n        .catch(() => {\n          this.validationError = this.$t(\"name_unique\");\n        });\n    },\n    createRole() {\n      this.$apollo\n        .mutate({\n          mutation: createRole,\n          // Parameters\n          variables: {\n            name: this.name,\n            slug: this.slug,\n            description: this.description,\n            users: this.users,\n            permissions: this.permissions\n          }\n        })\n        .then(data => {\n          M.toast({\n            html: `${this.$t(\"created_successfully\", {\n              name: data.data.createRole.name\n            })}`,\n            classes: \"success toast\",\n            displayLength: 3000\n          });\n\n          this.$router.push({ name: \"roles.index\" });\n        })\n        .catch(() => {\n          //console.log(e)\n          this.validationError = this.$t(\"name_unique\");\n        });\n    }\n  },\n  mounted() {\n    this.loadSelects();\n  }\n};\n</script>\n<style lang=\"scss\" scoped>\n.form-title {\n  font-weight: 700;\n  line-height: 3.6rem;\n  font-size: 2.64rem;\n  margin-bottom: 5rem;\n  & i {\n    font-size: 3.6rem;\n    vertical-align: bottom;\n  }\n}\n\nlabel {\n  font-size: 1.6rem !important;\n}\ninput,\n.checkbox span:not(.lever),\ntextarea,\nselect {\n  font-size: 1.6rem !important;\n  height: 4.2rem !important;\n}\n.checkbox {\n  position: relative;\n}\n</style>\n"]}]}